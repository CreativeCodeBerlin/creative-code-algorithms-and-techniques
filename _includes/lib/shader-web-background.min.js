// -- https://xemantic.github.io/shader-web-background/
const shaderWebBackground={};(()=>{'use strict';const t=(a,b)=>{b.initHalfFloatRGBATexture(b.width,b.height);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,
a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)},x=(a,b)=>{console.warn("shader-web-background cannot shade, adding fallback CSS classes");
document.documentElement.classList.add("shader-web-background-fallback");b.classList.add("shader-web-background-fallback");
if(a instanceof shaderWebBackground.GlError)console.warn("Not sufficient WebGL support:",
a);else throw a;};
function y(a,b){if(!a)throw new shaderWebBackground.ConfigError(b);}
function z(a){y(a instanceof HTMLCanvasElement,"config.canvas must be instance of canvas");
return a}
function A(){const a=document.createElement("canvas"),b=a.style;a.id="shader-web-background";b.width=
"100vw";b.height="100vh";b.position="fixed";b.top="0";b.left="0";b.zIndex=-9999;return a}
function B(a,b,d){y(a instanceof HTMLScriptElement&&a.type===b,'Shader source element of id "'+
d+'" should be of type: <script type="'+(b+'" id="'+d+'">'))}
function E(a){const b=document.getElementById(a);y(b,'Missing shader source: <script type="x-shader/x-fragment" id="'+
(a+'">'));B(b,"x-shader/x-fragment",a);return b.text}
function F(a){a+="Vertex";const b=document.getElementById(a);return b?(B(b,"x-shader/x-vertex",
a),b.text):"attribute vec2 V;void main(){gl_Position=vec4(V,0,1);}"}
function G(a,b){"loading"!==document.readyState?b():window.addEventListener(a,b)}
class H{constructor(a,b,d){this.g=b;this.h=()=>{for(const c of d)c()};this.i=()=>
{var c=b.u,e=a.gl;e.bindBuffer(e.ARRAY_BUFFER,a.j);e.enableVertexAttribArray(c);e.vertexAttribPointer(c,
2,e.FLOAT,!1,0,0);e.drawArrays(e.TRIANGLE_STRIP,0,4);e.disableVertexAttribArray(c);
e.bindBuffer(e.ARRAY_BUFFER,null);c=a.gl;for(e=0;e<a.g;e++)c.activeTexture(c.TEXTURE0+
e),c.bindTexture(c.TEXTURE_2D,null);a.g=0}}}
function I(a){var b={antialias:!1,depth:!1,alpha:!1};try{return new J(a,b)}catch(d){throw new shaderWebBackground.GlError(d.message);
}}
function K(a,b,d,c,e,n,p){function r(f,h,k){try{{var g=l;const m=g.gl,R=L(g,f,m.VERTEX_SHADER,h),
S=L(g,f,m.FRAGMENT_SHADER,k),v=m.createProgram();m.attachShader(v,R);m.attachShader(v,
S);m.linkProgram(v);var q=v}return q}catch(m){throw new shaderWebBackground.ConfigError(m.message);
}}const l=I(b),w=[];a.gl=l.gl;a.canvas=b;a.width=0;a.height=0;a.cssPixelRatio=0;a.cssWidth=
0;a.cssHeight=0;a.isOverShader=(f,h)=>{const k=b.getBoundingClientRect();return f>=
k.left&&f<=k.right&&h>=k.top&&h<=k.bottom};a.toShaderX=f=>(f-b.getBoundingClientRect().left)*
a.cssPixelRatio+.5;a.toShaderY=f=>b.height-(f-b.getBoundingClientRect().top)*a.cssPixelRatio-
.5;const C=()=>{const f=window.devicePixelRatio||1,h=b.clientWidth,k=b.clientHeight,
g=Math.floor(h*f),q=Math.floor(k*f);b.width=g;b.height=q;a.width=g;a.height=q;a.cssPixelRatio=
f;a.cssWidth=h;a.cssHeight=k;a.resolution=[g,q];l.gl.viewport(0,0,l.canvas.width,
l.canvas.height);for(const m of w)m.g.l(g,q)};a.buffers={};a.initHalfFloatRGBATexture=
(f,h)=>{l.h.g(f,h)};const T=Object.keys(d).length-1;let U=0;for(const f in d){if(U++<
T){const g=d[f].texture||t;a.buffers[f]=M(l,()=>{g(l.gl,a)})}const h=N(l,r(f,F(f),
E(f)),a.buffers[f]),k=d[f].uniforms||{};var u=Object.keys(k);for(const g of h.o)y(k[g.name],
'No configuration for uniform "'+g.name+'" defined in shader "'+f+'"'),u=u.filter(q=>
q!==g.name);0!==u.length&&console.warn('Extra uniforms configured for shader "'+f+
'", which are not present in the shader code - might have been removed by GLSL compiler if not used: '+
u.join(", "));u=h.o.map(g=>{const q=k[g.name];return"function"===typeof q?()=>{const m=
q(g.location);m&&g.m(m)}:()=>{g.m(q)}});w.push(new H(l,h,u))}const D=()=>{requestAnimationFrame(D);
if(0<b.getBoundingClientRect().top+b.height&&b.getBoundingClientRect().top<(window.innerHeight||
document.documentElement.clientHeight)){if(a.cssWidth!==b.clientWidth||a.cssHeight!==
b.clientHeight){C();var f=!0}else f=!1;f&&e&&e(a.width,a.height);n&&n();for(const h of w)h.g.i(h.h,
h.i);p&&p()}};G("load",()=>{C();c&&c();e&&e(a.width,a.height);requestAnimationFrame(D)})}
shaderWebBackground.Error=class extends Error{constructor(a){super(a);this.name="shaderWebBackground.Error"}};
shaderWebBackground.ConfigError=class extends shaderWebBackground.Error{constructor(a){super(a);
this.name="shaderWebBackground.ConfigError"}};
shaderWebBackground.GlError=class extends shaderWebBackground.Error{constructor(a){super(a);this.name=
"shaderWebBackground.GlError"}};
shaderWebBackground.shade=function(a){y(a,"Missing configurer argument");const b=
{};a=a(b);const d=a.canvas?z(a.canvas):A();y(a.shaders,"No shaders specified in config");
try{return K(b,d,a.shaders,a.onInit,a.onResize,a.onBeforeFrame,a.onAfterFrame),a.canvas||
G("DOMContentLoaded",()=>{document.body.appendChild(d)}),b}catch(c){(a.onError||x)(c,
d)}};const O=[-1,1,1,1,-1,-1,1,-1];
function P(a,b){return a.j(a.gl.getExtension(b),b+" extension is not supported")}
class Q{constructor(a,b){this.gl=a;this.j=b}g(){}}
class V extends Q{constructor(a,b){super(a,b);this.h=P(this,"OES_texture_half_float");
P(this,"OES_texture_half_float_linear")}g(a,b){const d=this.gl;d.texImage2D(d.TEXTURE_2D,
0,d.RGBA,a,b,0,d.RGBA,this.h.HALF_FLOAT_OES,null)}}
class W extends Q{constructor(a,b){super(a,b);P(this,"EXT_color_buffer_float");this.gl.getExtension("OES_texture_float_linear")}g(a,
b){const d=this.gl;d.texImage2D(d.TEXTURE_2D,0,d.RGBA16F,a,b,0,d.RGBA,d.HALF_FLOAT,
null)}}
function aa(a){a=a.split(/\r?\n/);const b=a.length.toString().length;var d=[];a.forEach((c,
e)=>{e=(e+1).toString();e=e.length>=b?e:" ".repeat(b-e.length)+e;d.push(e+": "+c+
"\n")});return d.join("")}const X=a=>a.map(b=>b?1:0);
function M(a,b){return new Y(a.gl,()=>{b(a.gl)})}
function N(a,b,d){const c=a.gl,e=[],n=c.getProgramParameter(b,c.ACTIVE_UNIFORMS);
for(let p=0;p<n;p++){const r=c.getActiveUniform(b,p),l=c.getUniformLocation(b,r.name);
e.push({name:r.name,info:r,location:l,m:ba(a,l,r.type)})}return{u:c.getAttribLocation(b,
"V"),o:e,l:d?(p,r)=>d.l(p,r):()=>{},i:(p,r)=>{c.useProgram(b);p();d?(p=d.g,d.g=d.h,
d.h=p,d.i(r)):r()}}}
function L(a,b,d,c){a=a.gl;d=a.createShader(d);a.shaderSource(d,c);a.compileShader(d);
if(!a.getShaderParameter(d,a.COMPILE_STATUS)){const e=String(a.getShaderInfoLog(d));
a.deleteShader(d);b="Cannot compile shader - "+b+": "+e;console.log(b);console.log(aa(c));
throw Error(b);}return d}
function ba(a,b,d){const c=a.gl;switch(d){case c.FLOAT:d=e=>c.uniform1f(b,e);break;
case c.FLOAT_VEC2:d=e=>c.uniform2fv(b,e);break;case c.FLOAT_VEC3:d=e=>c.uniform3fv(b,
e);break;case c.FLOAT_VEC4:d=e=>c.uniform4fv(b,e);break;case c.INT:d=e=>c.uniform1i(b,
e);break;case c.INT_VEC2:d=e=>c.uniform2iv(b,e);break;case c.INT_VEC3:d=e=>c.uniform3iv(b,
e);break;case c.INT_VEC4:d=e=>c.uniform4iv(b,e);break;case c.BOOL:d=e=>c.uniform1i(b,
e?1:0);break;case c.BOOL_VEC2:d=e=>c.uniform2iv(b,X(e));break;case c.BOOL_VEC3:d=
e=>c.uniform3iv(b,X(e));break;case c.BOOL_VEC4:d=e=>c.uniform4iv(b,X(e));break;case c.FLOAT_MAT2:d=
e=>c.uniformMatrix2fv(b,!1,e);break;case c.FLOAT_MAT3:d=e=>c.uniformMatrix3fv(b,!1,
e);break;case c.FLOAT_MAT4:d=e=>c.uniformMatrix4fv(b,!1,e);break;case c.SAMPLER_2D:d=
e=>{{const n=a.gl;e=e instanceof Y?e.g:e;n.activeTexture(n.TEXTURE0+a.g);n.bindTexture(n.TEXTURE_2D,
e);n.uniform1i(b,a.g++)}};break;default:throw Error("unknown type");}return d}
class J{constructor(a,b){this.canvas=a;const d=(e,n)=>{if(!e)throw Error(n);return e};
let c=a.getContext("webgl2",b);if(c)this.h=new W(c,d);else if(c=a.getContext("webgl",
b))this.h=new V(c,d);d(c,"webgl context not supported on supplied canvas element: "+
a);this.gl=c;a=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,a);c.bufferData(c.ARRAY_BUFFER,
new Float32Array(O),c.STATIC_DRAW);c.bindBuffer(c.ARRAY_BUFFER,null);this.j=a;this.buffers=
{};this.g=0}}
function Z(a){const b=a.gl,d=b.createTexture();b.bindTexture(b.TEXTURE_2D,d);a.s(b);
b.bindTexture(b.TEXTURE_2D,null);return d}
class Y{constructor(a,b){this.j=a.createFramebuffer();this.gl=a;this.s=b;this.g=this.h=
null}l(){this.h&&this.gl.deleteTexture(this.h);this.g&&this.gl.deleteTexture(this.g);
this.h=Z(this);this.g=Z(this)}i(a){const b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,
this.j);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this.g,
0);a();b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,
0);b.bindFramebuffer(b.FRAMEBUFFER,null)}};})()
